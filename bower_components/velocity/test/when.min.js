!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.Promise=e():"undefined"!=typeof global?global.Promise=e():"undefined"!=typeof self&&(self.Promise=e())}(function(){var e;return function r(e,t,n){function i(a,s){if(!t[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=t[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return i(n?n:t)},u,u.exports,r,e,t,n)}return t[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,n){var r=e("../lib/decorators/unhandledRejection"),i=t.exports=r(e("../lib/Promise")),o="undefined"!=typeof global&&global||"undefined"!=typeof self&&self;"undefined"!=typeof o&&"undefined"==typeof o.Promise&&(o.Promise=i)},{"../lib/Promise":2,"../lib/decorators/unhandledRejection":6}],2:[function(t,n,r){!function(e){"use strict";e(function(e){var t=e("./makePromise"),n=e("./Scheduler"),r=e("./async");return t({scheduler:new n(r)})})}("function"==typeof e&&e.amd?e:function(e){n.exports=e(t)})},{"./Scheduler":4,"./async":5,"./makePromise":7}],3:[function(t,n,r){!function(e){"use strict";e(function(){function e(e){this.head=this.tail=this.length=0,this.buffer=new Array(1<<e)}return e.prototype.push=function(e){return this.length===this.buffer.length&&this._ensureCapacity(2*this.length),this.buffer[this.tail]=e,this.tail=this.tail+1&this.buffer.length-1,++this.length,this.length},e.prototype.shift=function(){var e=this.buffer[this.head];return this.buffer[this.head]=void 0,this.head=this.head+1&this.buffer.length-1,--this.length,e},e.prototype._ensureCapacity=function(e){var o,t=this.head,n=this.buffer,r=new Array(e),i=0;if(0===t)for(o=this.length;o>i;++i)r[i]=n[i];else{for(e=n.length,o=this.tail;e>t;++i,++t)r[i]=n[t];for(t=0;o>t;++i,++t)r[i]=n[t]}this.buffer=r,this.head=0,this.tail=this.length},e})}("function"==typeof e&&e.amd?e:function(e){n.exports=e()})},{}],4:[function(t,n,r){!function(e){"use strict";e(function(e){function n(e){this._async=e,this._queue=new t(15),this._afterQueue=new t(5),this._running=!1;var n=this;this.drain=function(){n._drain()}}function r(e){for(;e.length>0;)e.shift().run()}var t=e("./Queue");return n.prototype.enqueue=function(e){this._add(this._queue,e)},n.prototype.afterQueue=function(e){this._add(this._afterQueue,e)},n.prototype._drain=function(){r(this._queue),this._running=!1,r(this._afterQueue)},n.prototype._add=function(e,t){e.push(t),this._running||(this._running=!0,this._async(this.drain))},n})}("function"==typeof e&&e.amd?e:function(e){n.exports=e(t)})},{"./Queue":3}],5:[function(t,n,r){!function(e){"use strict";e(function(e){var t,n;return t="undefined"!=typeof process&&null!==process&&"function"==typeof process.nextTick?function(e){process.nextTick(e)}:(n="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver)?function(e,t){function o(){var e=n;n=void 0,e()}var n,r=e.createElement("div"),i=new t(o);return i.observe(r,{attributes:!0}),function(e){n=e,r.setAttribute("class","x")}}(document,n):function(e){try{return e("vertx").runOnLoop||e("vertx").runOnContext}catch(t){}var n=setTimeout;return function(e){n(e,0)}}(e)})}("function"==typeof e&&e.amd?e:function(e){n.exports=e(t)})},{}],6:[function(t,n,r){!function(e){"use strict";e(function(e){function n(e){var t="object"==typeof e&&e.stack?e.stack:r(e);return e instanceof Error?t:t+" (WARNING: non-Error used)"}function r(e){var t=String(e);return"[object Object]"===t&&"undefined"!=typeof JSON&&(t=i(e,t)),t}function i(e,t){try{return JSON.stringify(e)}catch(e){return t}}function o(e){throw e}function a(){}var t=e("../timer");return function(e){function c(e){e.handled||(u.push(e),i("Potentially unhandled rejection ["+e.id+"] "+n(e.value)))}function d(e){var t=u.indexOf(e);t>=0&&(u.splice(t,1),s("Handled previous rejection ["+e.id+"] "+r(e.value)))}function p(e,n){l.push(e,n),f||(f=!0,f=t.set(h,0))}function h(){for(f=!1;l.length>0;)l.shift()(l.shift())}var i=a,s=a;"undefined"!=typeof console&&(i="undefined"!=typeof console.error?function(e){console.error(e)}:function(e){console.log(e)},s="undefined"!=typeof console.info?function(e){console.info(e)}:function(e){console.log(e)}),e.onPotentiallyUnhandledRejection=function(e){p(c,e)},e.onPotentiallyUnhandledRejectionHandled=function(e){p(d,e)},e.onFatalRejection=function(e){p(o,e.value)};var l=[],u=[],f=!1;return e}})}("function"==typeof e&&e.amd?e:function(e){n.exports=e(t)})},{"../timer":8}],7:[function(t,n,r){!function(e){"use strict";e(function(){return function(e){function r(e,t){this._handler=e===p?t:i(e)}function i(e){function r(e){t.resolve(e)}function i(e){t.reject(e)}function o(e){t.notify(e)}var t=new m;try{e(r,i,o)}catch(n){i(n)}return t}function o(e){return P(e)?e:new r(p,new y(c(e)))}function a(e){return new r(p,new y(new S(e)))}function s(){return _}function l(){return new r(p,new m)}function u(e){function u(e,t,r){this[e]=t,0===--n&&r.become(new x(this))}var o,a,s,l,t=new m,n=e.length>>>0,i=new Array(n);for(o=0;o<e.length;++o)if(s=e[o],void 0!==s||o in e)if(F(s))if(a=P(s)?s._handler.join():d(s),l=a.state(),0===l)a.fold(u,o,i,t);else{if(!(l>0)){t.become(a);break}i[o]=a.value,--n}else i[o]=s,--n;else--n;return 0===n&&t.become(new x(i)),new r(p,t)}function f(e){if(Object(e)===e&&0===e.length)return s();var n,i,t=new m;for(n=0;n<e.length;++n)i=e[n],void 0!==i&&n in e&&c(i).visit(t,t.resolve,t.reject);return new r(p,t)}function c(e){return P(e)?e._handler.join():F(e)?d(e):new x(e)}function d(e){try{var t=e.then;return"function"==typeof t?new w(t,e):new x(e)}catch(n){return new S(n)}}function p(){}function h(){}function m(e,t){r.createContext(this,t),this.consumers=void 0,this.receiver=e,this.handler=void 0,this.resolved=!1}function g(e){this.handler=e}function y(e){g.call(this,e)}function b(e,t){g.call(this,e),this.receiver=t}function w(e,n){m.call(this),t.enqueue(new L(e,n,this))}function x(e){r.createContext(this),this.value=e}function S(e){r.createContext(this),this.id=++T,this.value=e,this.handled=!1,this.reported=!1,this._report()}function C(e,t){this.rejection=e,this.context=t}function k(e){this.rejection=e}function j(){return new S(new TypeError("Promise cycle"))}function N(){return{state:"pending"}}function A(e,t){this.continuation=e,this.handler=t}function D(e,t){this.handler=t,this.value=e}function L(e,t,n){this._then=e,this.thenable=t,this.resolver=n}function O(e,t,n,r,i){try{e.call(t,n,r,i)}catch(o){r(o)}}function P(e){return e instanceof r}function F(e){return("object"==typeof e||"function"==typeof e)&&null!==e}function H(e,t,n,i){return"function"!=typeof e?i.become(t):(r.enterContext(t),M(e,t.value,n,i),void r.exitContext())}function R(e,t,n,i,o){return"function"!=typeof e?o.become(n):(r.enterContext(n),I(e,t,n.value,i,o),void r.exitContext())}function q(e,t,n,i,o){return"function"!=typeof e?o.notify(t):(r.enterContext(n),B(e,t,i,o),void r.exitContext())}function M(e,t,n,r){try{r.become(c(e.call(n,t)))}catch(i){r.become(new S(i))}}function I(e,t,n,r,i){try{e.call(r,t,n,i)}catch(o){i.become(new S(o))}}function B(e,t,n,r){try{r.notify(e.call(n,t))}catch(i){r.notify(i)}}function V(e,t){t.prototype=n(e.prototype),t.prototype.constructor=t}function z(){}var t=e.scheduler,n=Object.create||function(e){function t(){}return t.prototype=e,new t};r.resolve=o,r.reject=a,r.never=s,r._defer=l,r._handler=c,r.prototype.then=function(e,t){var n=this._handler;if("function"!=typeof e&&n.join().state()>0)return new r(p,n);var i=this._beget(),o=i._handler;return n.chain(o,n.receiver,e,t,arguments.length>2?arguments[2]:void 0),i},r.prototype["catch"]=function(e){return this.then(void 0,e)},r.prototype._bindContext=function(e){return new r(p,new b(this._handler,e))},r.prototype._beget=function(){var e=this._handler,t=new m(e.receiver,e.join().context);return new this.constructor(p,t)},r.all=u,r.race=f,p.prototype.when=p.prototype.become=p.prototype.notify=p.prototype.fail=p.prototype._unreport=p.prototype._report=z,p.prototype.inspect=N,p.prototype._state=0,p.prototype.state=function(){return this._state},p.prototype.join=function(){for(var e=this;void 0!==e.handler;)e=e.handler;return e},p.prototype.chain=function(e,t,n,r,i){this.when({resolver:e,receiver:t,fulfilled:n,rejected:r,progress:i})},p.prototype.visit=function(e,t,n,r){this.chain(v,e,t,n,r)},p.prototype.fold=function(e,t,n,r){this.visit(r,function(r){e.call(n,t,r,this)},r.reject,r.notify)},V(p,h),h.prototype.become=function(e){e.fail()};var v=new h;V(p,m),m.prototype._state=0,m.prototype.inspect=function(){return this.resolved?this.join().inspect():N()},m.prototype.resolve=function(e){this.become(c(e))},m.prototype.reject=function(e){this.resolved||this.become(new S(e))},m.prototype.join=function(){if(!this.resolved)return this;for(var e=this;void 0!==e.handler;)if(e=e.handler,e===this)return this.handler=j();return e},m.prototype.run=function(){var e=this.consumers,t=this.join();this.consumers=void 0;for(var n=0;n<e.length;++n)t.when(e[n])},m.prototype.become=function(e){this.resolved||(this.resolved=!0,this.handler=e,void 0!==this.consumers&&t.enqueue(this),void 0!==this.context&&e._report(this.context))},m.prototype.when=function(e){this.resolved?t.enqueue(new A(e,this.handler)):void 0===this.consumers?this.consumers=[e]:this.consumers.push(e)},m.prototype.notify=function(e){this.resolved||t.enqueue(new D(e,this))},m.prototype.fail=function(e){var t="undefined"==typeof e?this.context:e;this.resolved&&this.handler.join().fail(t)},m.prototype._report=function(e){this.resolved&&this.handler.join()._report(e)},m.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},V(p,g),g.prototype.inspect=function(){return this.join().inspect()},g.prototype._report=function(e){this.join()._report(e)},g.prototype._unreport=function(){this.join()._unreport()},V(g,y),y.prototype.when=function(e){t.enqueue(new A(e,this))},V(g,b),b.prototype.when=function(e){void 0!==this.receiver&&(e.receiver=this.receiver),this.join().when(e)},V(m,w),V(p,x),x.prototype._state=1,x.prototype.inspect=function(){return{state:"fulfilled",value:this.value}},x.prototype.fold=function(e,t,n,r){R(e,t,this,n,r)},x.prototype.when=function(e){H(e.fulfilled,this,e.receiver,e.resolver)};var T=0;V(p,S),S.prototype._state=-1,S.prototype.inspect=function(){return{state:"rejected",reason:this.value}},S.prototype.fold=function(e,t,n,r){this._unreport(),r.become(this)},S.prototype.when=function(e){this._unreport(),H(e.rejected,this,e.receiver,e.resolver)},S.prototype._report=function(e){t.afterQueue(new C(this,e))},S.prototype._unreport=function(){this.handled=!0,t.afterQueue(new k(this))},S.prototype.fail=function(e){r.onFatalRejection(this,void 0===e?this.context:e)},C.prototype.run=function(){this.rejection.handled||(this.rejection.reported=!0,r.onPotentiallyUnhandledRejection(this.rejection,this.context))},k.prototype.run=function(){this.rejection.reported&&r.onPotentiallyUnhandledRejectionHandled(this.rejection)},r.createContext=r.enterContext=r.exitContext=r.onPotentiallyUnhandledRejection=r.onPotentiallyUnhandledRejectionHandled=r.onFatalRejection=z;var E=new p,_=new r(p,E);return A.prototype.run=function(){this.handler.join().when(this.continuation)},D.prototype.run=function(){var e=this.handler.consumers;if(void 0!==e)for(var t,n=0;n<e.length;++n)t=e[n],q(t.progress,this.value,this.handler,t.receiver,t.resolver)},L.prototype.run=function(){function t(t){e.resolve(t)}function n(t){e.reject(t)}function r(t){e.notify(t)}var e=this.resolver;O(this._then,this.thenable,t,n,r)},r}})}("function"==typeof e&&e.amd?e:function(e){n.exports=e()})},{}],8:[function(t,n,r){!function(e){"use strict";e(function(e){var t,n,r,i;t=e;try{n=t("vertx"),r=function(e,t){return n.setTimer(t,e)},i=n.cancelTimer}catch(o){r=function(e,t){return setTimeout(e,t)},i=function(e){return clearTimeout(e)}}return{set:r,clear:i}})}("function"==typeof e&&e.amd?e:function(e){n.exports=e(t)})},{}]},{},[1])(1)});